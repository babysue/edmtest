<!-- ✅ EDM_EFORM.html（Email Only） -->
<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>活動報名 - Future Cities Symposium 2025</title>
  <style>
    body{font:16px/1.5 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial;color:#111;margin:0;background:#f8fafc}
    .wrap{max-width:900px;margin:0 auto;padding:20px 16px}
    .header{background:#fff;padding:30px;border-radius:12px;box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);margin-bottom:24px;text-align:center}
    .btn{display:inline-block;padding:12px 18px;background:#2563eb;color:#fff;border-radius:10px;text-decoration:none;border:0;cursor:pointer;font-weight:600;transition:all 0.2s}
    .btn:hover{background:#1d4ed8;transform:translateY(-2px)}
    .btn:disabled{background:#9ca3af;cursor:not-allowed;transform:none}
    .form-container{background:#fff;padding:30px;border-radius:12px;box-shadow:0 4px 6px -1px rgba(0,0,0,0.1)}
    form{display:grid;grid-template-columns:repeat(6,1fr);gap:20px;margin-top:20px}
    .field{grid-column:span 6;display:flex;flex-direction:column;gap:8px}
    .half{grid-column:span 6}
    @media(min-width:720px){.half{grid-column:span 3}}
    input,select{padding:14px;border:1px solid #e5e7eb;border-radius:10px;font:inherit;transition:all 0.2s;background:#fff}
    input:focus,select:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 3px rgba(37,99,235,0.1)}
    input:invalid:not(:focus):not(:placeholder-shown){border-color:#dc2626}
    .req{color:#dc2626}
    .hint{color:#6b7280;font-size:14px;margin-bottom:10px}
    .ok{display:none;margin-top:20px;padding:16px;border:1px solid #c7f9cc;background:#ecfdf5;border-radius:10px;color:#065f46}
    .err{display:none;color:#dc2626;font-size:14px;margin-top:10px;padding:12px;background:#fef2f2;border:1px solid #fecaca;border-radius:8px}
    .loading{display:none;color:#2563eb;font-size:14px;margin-top:10px}
    .field label{font-weight:600;color:#374151}
    .back-link{display:inline-block;margin-top:20px;color:#2563eb;text-decoration:none;font-weight:500}
    .back-link:hover{text-decoration:underline}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <h1>Future Cities Symposium 2025</h1>
      <p>報名表單 Registration Form</p>
    </div>
    <div class="form-container">
      <form id="f" novalidate>
        <div class="field half">
          <label for="first_name">First Name <span class="req">*</span></label>
          <input type="text" id="first_name" name="first_name" required placeholder="Benny">
        </div>
        <div class="field half">
          <label for="last_name">Last Name <span class="req">*</span></label>
          <input type="text" id="last_name" name="last_name" required placeholder="Liu">
        </div>
        <div class="field">
          <label for="email">Email Address <span class="req">*</span></label>
          <input type="email" id="email" name="email" required placeholder="you@example.com">
        </div>
        <div class="field">
          <label for="phone">Phone Number</label>
          <input type="tel" id="phone" name="phone" placeholder="Your phone number">
        </div>
        <div class="field">
          <label for="organization">Organization / Company</label>
          <input type="text" id="organization" name="organization" placeholder="Your organization">
        </div>
        <div class="field">
          <label for="job_title">Job Title</label>
          <input type="text" id="job_title" name="job_title" placeholder="Your job title">
        </div>
        <div class="field">
          <label for="company_type">公司性質類別 Company Type <span class="req">*</span></label>
          <select id="company_type" name="company_type" required>
            <option value="">Please select 請選擇</option>
            <option value="Public Company">Public Company 上市公司</option>
            <option value="Private Company">Private Company 私人公司</option>
            <option value="Government">Government 政府機構</option>
            <option value="Nonprofit">Nonprofit 非營利組織</option>
            <option value="Education">Education 教育機構</option>
            <option value="Startup">Startup 新創公司</option>
            <option value="Other">Other 其他</option>
          </select>
        </div>
        <div class="field">
          <label for="full_name_certificate">Full Name (for Certificate) <span class="req">*</span></label>
          <input type="text" id="full_name_certificate" name="full_name_certificate" required placeholder="First Last">
        </div>
        <div class="field">
          <button class="btn" type="submit" id="submit-btn">提交報名 Submit Registration</button>
          <div id="loading" class="loading">提交中，請稍候... Submitting...</div>
          <div id="err" class="err"></div>
          <div id="ok" class="ok">✅ 報名成功！我們已收到您的資訊。</div>
        </div>
      </form>
    </div>
  </div>

  <script>
    const postUrl = "https://script.google.com/macros/s/AKfycbw5Q4v-F8Sf3lAVHMqPAC2lfrzpkwCPYTmlL4E9bbawFZFJ8-OynY4zEStOxn9nzvA6sA/exec"; // ⚠️ 替換成你的 Google Apps Script URL

    document.getElementById('f').addEventListener('submit', async (e) => {
      e.preventDefault();

      const form = e.currentTarget;
      const submitBtn = document.getElementById('submit-btn');
      const loading = document.getElementById('loading');
      const err = document.getElementById('err');
      const ok = document.getElementById('ok');

      const data = Object.fromEntries(new FormData(form).entries());

      const requiredFields = ['first_name', 'last_name', 'email', 'company_type', 'full_name_certificate'];
      const missing = requiredFields.filter(field => !data[field]?.trim());

      if (missing.length > 0) {
        err.textContent = "❌ 請填寫所有必填欄位。";
        err.style.display = 'block';
        return;
      }

      const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;
      if (!emailRegex.test(data.email)) {
        err.textContent = "❌ 電子郵件格式不正確。";
        err.style.display = 'block';
        return;
      }

      err.style.display = 'none';
      ok.style.display = 'none';
      submitBtn.disabled = true;
      loading.style.display = 'block';

      try {
        const res = await fetch(postUrl, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });

        const result = await res.json();
        if (result.ok) {
          ok.style.display = 'block';
          form.reset();
        } else {
          throw new Error(result.error || '伺服器錯誤');
        }
      } catch (error) {
        err.textContent = "❌ 提交失敗：" + error.message;
        err.style.display = 'block';
      } finally {
        submitBtn.disabled = false;
        loading.style.display = 'none';
      }
    });
  </script>
</body>
</html>
